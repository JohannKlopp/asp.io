<!DOCTYPE html>
<html>
  <head>
    <title> visual layout </title>
    <link rel="stylesheet" type="text/css" href="css.css">
    <script src="participants allocation.js"> </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  </head>
<body>
      <h1> Please, enter your visual layout by clicking on any of the white boxes below. </h1>
      <p>Your tools:</p>
      <ul>
          <li><strong id='greenChair'>Green</strong> box: <strong>chair</strong> - your participants will be seated here. (1 click)</li>
          <li><strong id='blueTable'>Blue</strong> box: <strong>table</strong> (2 clicks)</li>
      </ul>
      <div class="buttoncontainer"></div>

      <script>
      /* creates all the buttons needed for the visual layout. */
      var rows = 40
      var columns = 15;
      for (var i = 0; i < rows; i++) {
        for (var j = 0; j < columns; j++) {
          $('div').append('<button class="whitebtn">_________</button>');
        }
        $('div').append('<br>');
      }
      </script>

      <script>
      /* function reads the cookie */
      function readCookie(name) {
          var nameEQ = name + "=";
          var ca = document.cookie.split(';');
          for(var i=0;i < ca.length;i++) {
              var c = ca[i];
              while (c.charAt(0)==' ') c = c.substring(1,c.length);
              if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
          }
          return null;
      }
      participants = readCookie("pCookie").split(",");
      console.log(participants);

        /* clicked button changes the colour and adds the first participant? */
        $('button').click(function() {
          toggleColour(this);
        });
        /* function to change between the three button classes */
        function toggleColour(btn) {
          var existingClass = $(btn).attr('class');
          console.log(existingClass);
          if (existingClass == 'bluebtn') {
            /* if existing class is blue, then change to white */
            $(btn).removeClass('bluebtn').addClass('whitebtn');
          } else if (existingClass == 'whitebtn') {
            /* if existing class is white, then change to green */
            $(btn).removeClass('whitebtn').addClass('greenbtn');
          }
          else {
            /* if existing class is green, change to blue */
            $(btn).removeClass('greenbtn').addClass('bluebtn');
          }
      }
      </script>

      <!-- This function is triggers the loop to get a random name frmo the cookie
      and a random green button and match them until all values in the array have been used-->
      <script>
        $(document).ready(function() {
          var $createSP = $('#createSP');
          $createSP.click(function() {
            var currentCookie = readCookie("pCookie").split(",");
            var allgreenButtons = document.getElementsByClassName('greenbtn');
            var arrayedButtons = Array.from(allgreenButtons);
            console.log(currentCookie.length);
            console.log(arrayedButtons);
            //-----------------------------------------------------------------
            var i;
            for (i = -currentCookie.length + 1; i <= currentCookie.length; i = i + 1){
              var randomNameIndex = Math.floor(Math.random() * currentCookie.length);
              var randomNameSplice = currentCookie.splice(randomNameIndex, 1);
              console.log(randomNameSplice);
              var randomButtonIndex = Math.floor(Math.random() * arrayedButtons.length);
              var randomButtonSplice = arrayedButtons.splice(randomButtonIndex, 1);
              console.log(randomButtonSplice);

              $(randomButtonSplice).text(randomNameSplice);
            }
          });
        });
      </script>
      <br></br>
      <!-- button to go to previous page -->
      <button id="navbutton" onclick="backtopi()">Back</button>
      <script> function backtopi(){
        window.location.href="participants input.html";
      }
      </script>
      <!-- This button triggers the above function (which in turn triggers the loop, etc.)-->
      <button id='createSP'>Create</button>

</body>
</html>
